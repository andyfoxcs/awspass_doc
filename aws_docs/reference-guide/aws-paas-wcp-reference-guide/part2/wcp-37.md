# WCP37-Local Synchronizing Merge(本地化同步汇聚) | AWS 流程引擎对WCP的支持评估

# WCP37-Local Synchronizing Merge(本地化同步汇聚)

将多个输入分支合并为一个输出分支，并在所有活动的输入分支都执行完成后，将控制传递给输出分支。有多少个分支需要被汇聚结构同步合并，是由本地可用的数据决定的。这些信息可能是前面的分支结构直接决定的，也可能需要基于本地数据（比如控制到达汇聚结构的线程）进行判断。

  * 在同一流程实例中，基于本地选出的多个线程的前置分支合并。这种模式是指可以在本地决定需要进行同步的分支。如果选择了分支A和C，则任务只拆分成两个，Sync. Merge也仅合并这两个任务。

## 解决方案

### 场景设计

  * “节点1”任务完成后，判断是否满足“条件1”或“条件2”
  * 如果满足“条件1”，则执行“节点2”任务
  * 如果满足“条件2”，则执行“节点3”任务
  * “节点3”任务完成后，判断审核菜单，“同意”，则执行“节点4”任务，“不同意”，则执行“节点5”任务
  * 当满足条件的节点任务都执行完过后，执行“节点6”任务
  * “节点6”任务完成后，流程结束

### 流程建模

![](https://docs.awspaas.com/reference-guide/aws-paas-wcp-reference-guide/part2/wcp37-process-model.png)

> 可以在`工作流控制模式概念验证`应用的`流程模型>2.Advanced Branching and Synchronization Patterns(高级分支和同步模式)>WCP37-Local Synchronizing Merge(本地化同步汇聚)`中访问该流程模型

### 引擎执行

  * 确认已安装`工作流控制模式概念验证`应用，访问前端`WCP概念验证`菜单入口
  * 在左侧树中点击`WCP37-Local Synchronizing Merge(本地化同步汇聚)`项
  * 在列表中点击`新建`按钮，流程实例被创建
  * 此时，“节点1”已创建一个任务实例，点击`办理`按钮，完成任务
  * 此时，引擎判断是否满足“条件1”或“条件2”
  * 若仅“条件1”满足，则“节点2”创建一个任务实例，在列表打开该任务，点击`办理`按钮，完成任务。此时，“节点6”已创建一个任务实例，在列表打开该任务，点击`办理`按钮，完成任务，流程实例结束
  * 若仅“条件2”满足，则“节点3”创建一个任务实例，在列表打开该任务，点击`办理`按钮，完成任务。判断“节点3”任务的审核菜单，若“同意”，则“节点4”创建一个任务实例，若“不同意”，则“节点5”创建一个任务实例，在列表打开该任务，点击`办理`按钮，完成任务。此时，“节点6”已创建一个任务实例，在列表打开该任务，点击`办理`按钮，完成任务，流程实例结束
  * 若同时满足“条件1”和“条件2”，则“节点2”和“节点3”同时创建任务实例，在列表打开这两个任务，点击`办理`按钮，完成任务
  * 两个节点都完成后，“节点6”已创建一个任务实例，在列表打开该任务，点击`办理`按钮，完成任务，流程实例结束

> 如果列表中未出现`新建`按钮，请首先为此用户设置可启动该流程的权限