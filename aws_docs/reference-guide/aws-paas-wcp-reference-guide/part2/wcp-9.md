# WCP9-Structured Discriminator(结构化鉴别器) | AWS 流程引擎对WCP的支持评估

## WCP9-Structured Discriminator(结构化鉴别器)

将两个或多个分支合并为一个，当多条分支中的一个先完成后，控制流即传递到后续分支上。其他分支完成后，不再继续执行。所有输入分支完成后， _结构化鉴别器_(Discriminator)结构复位。结构化鉴别器必须与并行分支配合使用， _结构化鉴别器_ 要合并所有 _并行分支_ 结构的所有输出分支，并且 _并行分支_ 结构和 _结构化鉴别器_ 之间的分支不能有分解或合并。

  * 在同一流程实例中，基于条件合并前置条件产生的多个分支后执行后继分支。如果B先执行完，到达Discriminator后继续向后执行，当C执行完到达Discriminator后，则被忽略，不再继续执行。
  * 例如供应商采购报价，如果有三个主管部门的一个部门不通过，就需要重新议价。

## 解决方案

### 场景设计

  * “节点1”任务完成后，并行执行“节点2”和“节点3”
  * 如果“节点2”任务先完成，则执行“节点4”，“节点3”任务完成后，不再向下执行
  * 如果“节点3”任务先完成，则执行“节点4”，“节点2”任务完成后，不再向下执行
  * “节点4”任务完成后，流程结束

### 流程建模

![](https://docs.awspaas.com/reference-guide/aws-paas-wcp-reference-guide/part2/wcp9-process-model.png)

> 可以在`工作流控制模式概念验证`应用的`流程模型>2.Advanced Branching and Synchronization Patterns(高级分支和同步模式)>WCP9-Structured Discriminator(结构化鉴别器)`中访问该流程模型

### 引擎执行

  * 确认已安装`工作流控制模式概念验证`应用，访问前端`WCP概念验证`菜单入口
  * 在左侧树中点击`WCP9-Structured Discriminator(结构化鉴别器)`项
  * 在列表中点击`新建`按钮，流程实例被创建
  * 此时，“节点1”已创建一个任务实例，点击`办理`按钮，完成任务
  * 此时，“节点2”和“节点3”分别创建一个任务实例，在列表分别打开这两个任务，点击`办理`按钮，完成任务
  * 如果“节点2”任务先完成，则“节点4”创建一个任务实例，当“节点3”任务完成后，被忽略，不再继续执行
  * 如果“节点3”任务先完成，同理
  * 如果“节点2”任务和“节点3”任务同时完成，则“节点4”只创建一个任务实例
  * 在列表中打开“节点4”任务，点击`办理`按钮，完成任务，流程实例结束

> 如果列表中未出现`新建`按钮，请首先为此用户设置可启动该流程的权限