# 按角色/岗位 · AWS PaaS文档中心

## 按角色

### 方案10：（角色/岗位）/（固定角色/岗位）

一个或多个角色的人员合并，剔除匹配范围外的用户。

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa7.png)](<fa7.png>)

项 | 说明  
---|---  
添加范围 > 组织类型 | ．实体单位  
．实体部门  
．虚拟单位  
．虚拟部门  
添加范围 > 组织ID | 对应组织类型的ID  
添加范围 > 匹配规则 | 仅在组织类型为`实例部门`和`虚拟部门`时有效  
．`本部门` 列出本部门并符合所选角色的用户   
．`本部门及以上` 列出本部门及所有上级部门直到单位并符合所选角色的用户   
．`本部门及以上，找到即退出` 从本部门开始找并符合所选角色的用户，找到后就不继续再向上找其他部门的了   
．`本部门及以下` 列出本部门及所有下级部门并符合所选角色的用户   
．`本部门及以下，找到即退出` 从本部门开始找并符合所选角色的用户，找到后就不继续再向下找其他部门的了  
角色 | 设定可匹配的角色，支持多个  
支持兼任 | 勾选后，支持兼任的人员  
  
### 方案11：（角色/岗位）/来自公式

使用@公式指定角色（通过@公式解析获取角色ID，多个空格隔开）

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa7-1.png)](<fa7-1.png>)

项 | 说明  
---|---  
角色 | 设定可匹配的角色，支持@公式解析获取角色ID，多个空格隔开  
添加范围 > 组织类型 | ．实体单位  
．实体部门  
．虚拟单位  
．虚拟部门  
添加范围 > 公式 | 使用@公式指定角色（通过@公式解析获取角色ID，多个空格隔开）  
添加范围 > 匹配规则 | 仅在组织类型为`实例部门`和`虚拟部门`时有效  
．`本部门` 列出本部门并符合所选角色的用户   
．`本部门及以上` 列出本部门及所有上级部门直到单位并符合所选角色的用户   
．`本部门及以上，找到即退出` 从本部门开始找并符合所选角色的用户，找到后就不继续再向上找其他部门的了   
．`本部门及以下` 列出本部门及所有下级部门并符合所选角色的用户   
．`本部门及以下，找到即退出` 从本部门开始找并符合所选角色的用户，找到后就不继续再向下找其他部门的了  
支持兼任 | 勾选后，支持兼任的人员  
  
### 方案12：（角色/岗位）/来自表单

获取表单上某个字段来指定角色（通过表单字段的值获取角色ID，多个空格隔开）

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa7-2.png)](<fa7-2.png>)

项 | 说明  
---|---  
字段名称 | 仅支持主表单上的表单字段名称  
添加范围 > 组织类型 | ．实体单位  
．实体部门  
．虚拟单位  
．虚拟部门  
添加范围 > 字段名称 | 获取表单上某个字段来指定角色（通过表单字段的值获取角色ID，多个空格隔开），仅支持主表单字段  
添加范围 > 匹配规则 | 仅在组织类型为`实例部门`和`虚拟部门`时有效  
．`本部门` 列出本部门并符合所选角色的用户   
．`本部门及以上` 列出本部门及所有上级部门直到单位并符合所选角色的用户   
．`本部门及以上，找到即退出` 从本部门开始找并符合所选角色的用户，找到后就不继续再向上找其他部门的了   
．`本部门及以下` 列出本部门及所有下级部门并符合所选角色的用户   
．`本部门及以下，找到即退出` 从本部门开始找并符合所选角色的用户，找到后就不继续再向下找其他部门的了  
支持兼任 | 勾选后，支持兼任的人员  
  
### 方案13：（角色/岗位）/来自变量

从当前流程变量来指定角色（通过流程变量的值获取角色ID，多个空格隔开）

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa7-3.png)](<fa7-3.png>)

项 | 说明  
---|---  
流程变量 | 从当前流程变量来指定角色，支持多个，用空格隔开  
匹配范围 > 组织类型 | ．实体单位  
．实体部门  
．虚拟单位  
．虚拟部门  
添加范围 > 流程变量 | 从当前流程变量来指定角色（通过流程变量的值获取角色ID，多个空格隔开）  
添加范围 > 匹配规则 | 仅在组织类型为`实例部门`和`虚拟部门`时有效  
．`本部门` 列出本部门并符合所选角色的用户   
．`本部门及以上` 列出本部门及所有上级部门直到单位并符合所选角色的用户   
．`本部门及以上，找到即退出` 从本部门开始找并符合所选角色的用户，找到后就不继续再向上找其他部门的了   
．`本部门及以下` 列出本部门及所有下级部门并符合所选角色的用户   
．`本部门及以下，找到即退出` 从本部门开始找并符合所选角色的用户，找到后就不继续再向下找其他部门的了  
支持兼任 | 勾选后，支持兼任的人员  
  
### 方案14：（角色/岗位）/动态角色

由规则动态指定角色和范围，剔除匹配范围外的用户。

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa8.png)](<fa8.png>)

项 | 说明  
---|---  
范围 | ．全部  
．实体单位  
．实体部门  
．虚拟单位  
．虚拟部门  
范围ID | 对应组织类型的ID  
角色ID | 设定可匹配的角色ID,支持@公式  
支持兼任 | 勾选后，支持兼任的人员  
  
### 方案15：（角色/岗位）/与上个任务办理人所在组织结构的位置相关

以上个任务办理人所在部门为始点，直线向上（金字塔路线）或平行递归（矩阵路线）查找该部门内的角色的人，终止于找到合适人员。

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa9.png)](<fa9.png>)

项 | 说明  
---|---  
优先角色 | 优先寻找的角色  
候选角色 | 当优先角色无相关人员时，从候选角色中寻找  
路线算法 | ．平行递归，矩阵算法  
．直线向上，金字塔路线  
支持兼任 | 勾选后，支持兼任的人员  
  
#### 平行递归，矩阵算法

以上个任务办理人所在部门为原点进行角色匹配（如支持兼任则兼任也被找到；如不支持，则不被找到），若未发现则逐一在平行部门内进行角色与人员的匹配，若仍然未发现，再向上层层递归，当有角色人员被匹配时，终止计算。路由算法路径示意图如下

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa9.1.png)](<fa9.1.png>)  

_图中张三提交申请，需要‘销售部长’角色的人办理，寻找路线如下： A11——〉A12——〉A1——〉A2、A3 ——〉A21、A22、A31 ——〉A——〉B、C——〉B1、B2、C1——〉B11、B12、B21、B22，依次类推寻找下去。直到找到合适的‘销售部长’时结束。如果在同一层找到多个人员信息，提供给用户自己选择。（若图中张三所在部门存在子部门，其寻找方法优先级依次为：当前部门、下级部门和上述路线）_

> 按上述算法部门首先进行优先角色与人员的匹配，如果所有部门都没有匹配上再与候选角色匹配

#### 直线向上，金字塔路线

以上个任务办理人所在部门为原点进行角色匹配（如支持兼任则兼任也被找到；如不支持，则不被找到），若未发现则向父部门寻找，该部门有指定角色的人员时（同部门内若存在该角色多个人会被一同选用），但将不再继续向上寻找。

> 按直线向上算法寻找部门首先进行优先角色与人员的匹配，如果所有部门都没有匹配上再与候选角色匹配

### 方案16：角色/与指定任务办理人所在组织结构的位置相关

以指定任务的办理人所在部门为始点，直线向上（金字塔路线）或平行递归（矩阵路线）查找该部门内的角色的人，终止于找到合适人员。

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa10.png)](<fa10.png>)

项 | 说明  
---|---  
任务ID | 支持@公式,一个任务ID  
优先角色 | 优先寻找的角色  
候选角色 | 当优先角色无相关人员时，从候选角色中寻找  
路线算法 | ．平行递归，矩阵算法  
．直线向上，金字塔路线  
支持兼任 | 勾选后，支持兼任的人员  
  
### 方案17：（角色/岗位）/与流程申请人所在组织结构的位置相关

以流程申请人所在部门为始点，直线向上（金字塔路线）或平行递归（矩阵路线）查找该部门内角色的人，终止于找到合适人员。

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa11.png)](<fa11.png>)

项 | 说明  
---|---  
优先角色 | 优先寻找的角色  
候选角色 | 当优先角色无相关人员时，从候选角色中寻找  
路线算法 | ．平行递归，矩阵算法  
．直线向上，金字塔路线  
支持兼任 | 勾选后，支持兼任的人员  
  
### 方案18：（角色/岗位）/共享任务

该任务共享给一个特定的角色，该角色的用户可以通过认领完成该任务。

[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa12.png)](<fa12.png>)

项 | 说明  
---|---  
角色ID | 支持@公式,一个角色ID  
  
>   1. 该路由方案需在%AWS_HOME%\bin\conf\bpmn.properties文件`ENGINE_CLAIM_SUPPORT`属性值中开启，默认关闭。
>   2. 使用该路由方案时，`角色范围`和基本属性中`串/并签`属性设置无效
>   3. 默认共享任务不显示在用户待办任务列表中，需在AWS Portal门户参数`待办任务是否显示认领任务`开启[![](https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-process-64ga/manual_task/fa12.1.png)](<fa12.1.png>)
>   4. 共享任务需由用户认领，也可由admin用户在实例运维管理进行分配，详细参见<https://docs.awspaas.com/user-manual/aws-pass-console-user-manual-prm/operate_guidance/no_people.html>
> 

#### 用API创建、认领共享任务
    
    
    //创建共享任务
    SDK.getTaskAPI().createUserClaimTaskInstance(processInst, parentTaskInstModel,userContext, targetActivityDefId, claimType, claimResourceId, title);
    
    //认领共享任务
    SDK.getTaskAPI().claimTask(taskInstId, uid);
    
    //判断任务是共享任务还是私有任务断
    SDK.getTaskAPI().isClaimTask(taskInstId)