# WCP33-Generalised AND-Join(一般并行合并) | AWS 流程引擎对WCP的支持评估

## WCP33-Generalised AND-Join(一般并行合并)

在同一流程实例中，两个或多个同时执行的并行分支合并汇聚到一个分支上。合并分支被触发期间，从一个或多个分支上接收到的额外的触发会被保留并用于之后的触发。随时间推移，每个输入分支应该给合并结构传递相同数量的触发（这些触发的时间可能不同）。

  * 在同一流程实例中，基于多个线程的前置分支合并。Gen.AND连接多个并发分支，当任务B执行完后进入Gen. AND连接，这个连接会保留这些triggers，直到任务C执行完到达该连接。
  * 例如当所有董事签名的任务完成时，执行完成合同任务。

## 解决方案

### 场景设计

  * 并行执行“节点1”和“节点2”
  * “节点1”和“节点2”执行完成后，“节点3”和“节点4”分别产生两个待执行任务
  * 执行完成一个“节点3”任务和一个“节点4”任务后，“节点5”产生一个待执行任务
  * 执行完成另一个“节点3”任务和“节点4”任务后，“节点5”再产生一个待执行任务
  * 两个“节点5”都完成后，流程结束

### 流程建模

![](https://docs.awspaas.com/reference-guide/aws-paas-wcp-reference-guide/part2/wcp33-process-model.png)

> 可以在`工作流控制模式概念验证`应用的`流程模型>2.Advanced Branching and Synchronization Patterns(高级分支和同步模式)>WCP33-Generalised AND-Join(一般并行合并)`中访问该流程模型

### 引擎执行

  * 确认已安装`工作流控制模式概念验证`应用，访问前端`WCP概念验证`菜单入口
  * 在左侧树中点击`WCP33-Generalised AND-Join(一般并行合并)`项
  * 在列表中点击`新建`按钮，流程实例被创建
  * 此时，“节点1”和“节点2”已分别创建一个任务实例，分别打开“节点1”和“节点2”任务，点击`办理`按钮，完成任务
  * 此时，“节点3”和“节点4”分别创建了两个任务实例
  * 执行完成一个“节点3”任务和一个“节点4”任务后，“节点5”产生一个待执行任务
  * 打开“节点5”任务，点击`办理`按钮，完成任务，分支结束
  * 执行完成另一个“节点3”任务和“节点4”任务后，“节点5”再产生一个待执行任务
  * 打开“节点5”任务，点击`办理`按钮，完成任务，流程结束

> 如果列表中未出现`新建`按钮，请首先为此用户设置可启动该流程的权限