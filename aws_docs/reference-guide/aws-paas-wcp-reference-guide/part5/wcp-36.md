# WCP36-Dynamic Partial Join for Multiple Instances(动态多例合并) | AWS 流程引擎对WCP的支持评估

## WCP36-Dynamic Partial Join for Multiple Instances(动态多例合并)

在某一个流程实例中，某个任务可以创建多个并发实例。产生的实例的个数取决于一些运行时因素，包括状态数据、资源可用性和进程间通信，直到最后一个实例完成后才知道。在任何时候，虽然实例运行，提供额外的实例启动的功能是可能的，并没有被禁止。指定了一个完成条件，每次任务的实例完成时都将被评估。一旦完成条件评估为真，则该流程实例中的下一个任务被触发。随后剩下的任务实例都是无关紧要的，不会产生新的实例。

  * 在同一流程中，可以在运行期间任意添加的实例，并在每个实例结束后判断是否符合完成条件。一旦完成条件满足，就会触发之后的任务执行。
  * 石油运输从工厂到选定位置涉及多种运输任务，根据运输量初步估计，但如果运输需求不足总会产生额外任务。一旦90%的交通运输任务完成，下一个任务可以开始。

## 解决方案

### 场景设计

  * “节点1”任务办理时指定“节点2”任务的办理者
  * 多个办理者会同时收到"节点2”任务，当办理者办理“节点2”任务实例后回触发“节点2”任务的“任务完成后事件”，判断办理者选择的审核菜单，如果选择的是“同意”，则取消“节点2”的其它任务实例，完成“节点2”任务，流程结束

### 流程建模

![](https://docs.awspaas.com/reference-guide/aws-paas-wcp-reference-guide/part5/wcp36-process-model.png)

> 可以在`工作流控制模式概念验证`应用的`流程模型>5.Multiple Instance Patterns(多实例模式)>WCP36-Dynamic Partial Join for Multiple Instances(动态多例合并)`中访问该流程模型

### 引擎执行

  * 确认已安装`工作流控制模式概念验证`应用，访问前端`WCP概念验证`菜单入口
  * 在左侧树中点击`WCP36-Dynamic Partial Join for Multiple Instances(动态多例合并)`项
  * 在列表中点击`新建`按钮，流程实例被创建
  * 此时，“节点1”已经创建一个任务实例，点击`办理`按钮，指定“节点2”任务的办理者，完成任务
  * 多个办理者会同时收到“节点2”任务，在任务列表中打开“节点2”任务实例，选择审核菜单，点击`办理`按钮，完成任务实例，在“节点2”任务实例完成后，触发“节点2”的“任务完成后事件”，判断办理则选择的审核菜单，如何审核菜单选择的是“同意”，则取消“节点2”任务的其它任务实例，完成“节点”任务，流程结束

> 如果列表中未出现`新建`按钮，请首先为此用户设置可启动该流程的权限