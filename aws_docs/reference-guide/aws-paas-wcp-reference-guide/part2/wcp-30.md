# WCP30-Structured Partial Join(结构化部分合并) | AWS 流程引擎对WCP的支持评估

## WCP30-Structured Partial Join(结构化部分合并)

将两个或多个（设为m）分支合并为一个，当多个分支中的n个先完成后，控制流即传递到后续分支上（n小于m）。其他分支完成后，不再继续执行。所有输入分支完成后，该合并结构复位。 _部分合并_ 结构必须与 _并行分支_ 配合使用， _部分合并_ 结构要合并所有 _并行分支_ 结构的所有输出分支，并且 _并行分支_ 结构和 _部分合并_ 结构之间的分支不能有分解或合并。

  * 在同一流程实例中，基于分支完成数量的合并。图中示例是从三个分支中选择两个，当任务B和C先执行完到达Join，合并后继续向后执行，任务D执行完到达Join后被忽略。
  * 例如某个立项审批一旦有两个部门执行完，就执行后继的分支。

## 解决方案

### 场景设计

  * 并行执行“节点1”、“节点2”和“节点3”
  * 三个任务中的两个先完成后，则执行“节点4”
  * 复杂网关的输入分支上的其他分支任务完成后，不再向后继续执行
  * “节点4”完成后，流程结束

### 流程建模

![](https://docs.awspaas.com/reference-guide/aws-paas-wcp-reference-guide/part2/wcp30-process-model.png)

> 可以在`工作流控制模式概念验证`应用的`流程模型>2.Advanced Branching and Synchronization Patterns(高级分支和同步模式)>WCP30-Structured Partial Join(结构化部分合并)`中访问该流程模型

### 引擎执行

  * 确认已安装`工作流控制模式概念验证`应用，访问前端`WCP概念验证`菜单入口
  * 在左侧树中点击`WCP30-Structured Partial Join(结构化部分合并)`项
  * 在列表中点击`新建`按钮，流程实例被创建
  * 此时，“节点1”、“节点2”和“节点3”已分别创建一个任务实例
  * 打开“节点1”任务，点击`办理`按钮，完成任务
  * 打开“节点2”任务，点击`办理`按钮，完成任务
  * 此时，“节点4”已创建了一个任务实例
  * 打开“节点3”任务，点击`办理`按钮，完成任务，该任务实例的完成会被忽略，不再继续执行
  * 在列表中打开“节点4”任务，点击`办理`按钮，完成任务，流程实例结束

> 如果列表中未出现`新建`按钮，请首先为此用户设置可启动该流程的权限